<div class="product-list-container">
  <div class="container">
    <div class="hero-banner">
      <div class="hero-overlay"></div>
      <div class="hero-image-bg">
        <img src="assets/image/vue-de-l-etal-de-poisson-sur-le-marche-de-sanarysurmer.jpg" alt="Poissonnerie">
      </div>
      <div class="hero-content">
        <h1>SIGNARE POISSONNERIE</h1>
        <p>D√©couvrez nos poissons frais de qualit√©, directement de la mer √† votre table</p>
      </div>
    </div>
    <div class="filter-section">
      <div class="filter-card">
        <div class="filter-header">
          <h3>Filtres</h3>
        </div>
        <div class="filter-content">
          <div class="filter-group">
            <label>Entrep√¥t</label>
            <select [(ngModel)]="selectedEntrepotId" (change)="onEntrepotChange()" class="filter-select">
              <option [value]="null" disabled>S√©lectionner un entrep√¥t</option>
              <option *ngFor="let entrepot of entrepots" [value]="entrepot.id">
                {{ entrepot.nom }} - {{ entrepot.ville }}
              </option>
            </select>
          </div>

          <div class="filter-group" *ngIf="selectedEntrepotId">
            <label>Rechercher</label>
            <div class="search-input-wrapper">
              <input type="text" 
                     [(ngModel)]="searchProduct" 
                     (input)="onSearchChange()"
                     placeholder="Nom ou code produit..."
                     class="filter-input">
              <span class="search-icon">üîç</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div *ngIf="loading" class="loading-container">
      <mat-spinner diameter="32"></mat-spinner>
      <p>Chargement...</p>
    </div>

    <div *ngIf="!loading && filteredProducts.length === 0 && products.length > 0" class="empty-state">
      <p>Aucun produit trouv√©</p>
    </div>

    <div *ngIf="!loading && products.length === 0" class="empty-state">
      <p>Aucun produit disponible</p>
    </div>

    <div class="product-grid" *ngIf="!loading && filteredProducts.length > 0">
      <div *ngFor="let product of filteredProducts" class="product-card">
        <div class="product-image-container">
          <img *ngIf="hasValidImage(product)" 
               [src]="getImageUrl(product.imagePath!)" 
               [alt]="product.nom" 
               class="product-image"
               (error)="onImageError($event)"
               (load)="onImageLoad($event)">
          <div *ngIf="!hasValidImage(product)" class="product-image-placeholder">
            <mat-icon>image</mat-icon>
          </div>
          <div class="stock-badge" [class.in-stock]="product.quantityAvailable > 0" [class.out-of-stock]="product.quantityAvailable === 0">
            <span class="badge-dot"></span>
            <span>{{ product.quantityAvailable > 0 ? 'En stock' : 'Rupture' }}</span>
          </div>
        </div>
        <div class="product-content">
          <h3 class="product-title">{{ product.nom }}</h3>
          <div class="product-price">
            <span class="price-amount">{{ product.price | number }} FCFA</span>
            <span class="price-unit">/ kg</span>
          </div>
        </div>
        <div class="product-actions">
          <button class="add-to-cart-btn"
                  (click)="openQuantityDialog(product)" 
                  [disabled]="product.quantityAvailable === 0">
            <span class="btn-icon">+</span>
            <span>Ajouter</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
